# Nginx OSS vs Traefik 의사결정 문서 (AI 모델 서빙 플랫폼)

작성일: 2025-12-24

## 1. 목적 및 범위
본 문서는 AI 모델을 이용한 기능 제공을 위한 **서버 내 Docker(Compose 포함) 기반** 운영 환경을 전제로, **Edge/Gateway(Reverse Proxy) 계층**에서 사용할 수 있는 **Nginx OSS**와 **Traefik**을 비교하고, 현 단계 및 성장 단계에서의 기술 선택 기준과 권고안을 정리한다.

본 문서의 비교 범위는 다음 Gateway 책임에 한정한다.
- TLS 종료(SSL Termination)
- 라우팅(Host/Path, 헤더 기반, Rewrite 등)
- 공통 정책(Rate Limit, CORS, 헤더 정책)
- 스트리밍(SSE/WebSocket) 경로의 안정적 전달
- 운영 관점(설정/배포/관측/장애 대응)

학습 파이프라인, 모델 엔진(Triton/vLLM 등) 선택, Temporal 기반 오케스트레이션은 본 문서의 직접 비교 대상이 아니다.

---

## 2. 용어 정의
- **Nginx OSS**: nginx.conf 기반으로 운영되는 오픈소스 Nginx 웹서버/리버스 프록시.
- **Traefik**: 클라우드 네이티브 지향의 리버스 프록시. Docker/Kubernetes 등 Provider로부터 동적 라우팅 구성을 수신하며, Router/Service/Middleware 모델로 정책을 적용.

> 주의: Kubernetes 환경에서의 “Nginx”는 ingress-nginx/NGINX Ingress Controller를 의미할 수 있으나, 본 문서의 현재 전제는 **서버 내 Docker 환경의 Nginx OSS**이다.

---

## 3. 핵심 결론(Executive Summary)
1) **현재(서버 내 Docker, 중·소규모 팀, AI 기능 제공 단계)**에서는 **Nginx OSS 단독** 구성이 가장 일관되고 운영 리스크가 낮다.
- 운영 복잡도를 최소화(프록시 체인 중복 방지)
- LLM/음성 등 스트리밍(SSE/WS) 및 타임아웃/버퍼링 제어에 유리
- 표준 레퍼런스가 풍부하고 장애 대응이 용이

2) **성장 이후 Traefik의 유의미성**은 “규모” 자체보다는 **운영 형태의 변화**에 의해 결정된다.
- Kubernetes 전환(또는 멀티 클러스터)
- 서비스 수 증가 및 라우팅/정책 변경 빈도 증가
- GitOps/CRD/Provider 기반의 동적 라우팅 운영이 필요

3) **Nginx와 Traefik는 기본적으로 대체 관계**이다.
- 동일 위치(80/443)에서 동시 사용은 중복과 운영 포인트 증가를 야기
- 다만 DMZ/보안 분리 등 구조적 제약이 있으면 계층 분리를 통해 보완적으로 공존 가능

---

## 4. 전제 조건(Assumptions)
- 운영은 Kubernetes가 아닌 **서버 내 Docker 환경(Compose 포함)**을 기본으로 한다.
- 목표는 “대규모 API 관리 플랫폼”이 아니라 **AI 모델 서빙을 위한 공통 기반(Foundation)**을 제공하는 것이다.
- 중·소규모 인원으로 운영하며, 인프라 복잡도는 최소화하는 것이 우선순위다.

---

## 5. 대체 관계 vs 상호보완 관계
### 5.1 기본 관계: 대체(동일 역할)
- 두 제품 모두 Edge에서 L7 Reverse Proxy/Gateway로서 TLS 종료, 라우팅, 공통 정책을 수행할 수 있다.
- 따라서 **한 자리(서버의 80/443)에는 하나만** 두는 것이 일반적으로 바람직하다.

### 5.2 상호보완이 되는 제한적 공존 패턴
- **패턴 A: Edge Nginx + 내부 Traefik**
  - Nginx: 인터넷-facing, 보수적 운영(스트리밍/타임아웃/정책)
  - Traefik: 내부 Docker 네트워크에서 라벨 기반 동적 라우팅
  - 적용 조건: 보안/DMZ 분리, 외부 진입점 고정 요구가 강한 경우

- **패턴 B: Edge Traefik + 서비스별 Nginx**
  - Traefik: 외부 진입점과 서비스 라우팅
  - Nginx: 특정 워크로드(정적 파일/캐시/특수 라우팅)만 국소 최적화
  - 적용 조건: 특정 서비스에만 Nginx 강점이 필요할 때

> 권고: 단일 서버/소규모 운영에서는 특별한 이유가 없다면 공존 패턴을 피하고 단독 구성을 유지한다.

---

## 6. 비교 분석(의사결정 축)

### 6.1 운영 철학 및 설정 방식
- **Nginx OSS**
  - 명시적 설정(nginx.conf)
  - 변경 시 구성 배포 및 reload가 필요
  - 구성 자체가 단순하며 통제 범위가 명확

- **Traefik**
  - Static/Dynamic 설정 분리
  - Docker Provider를 통한 라벨 기반 자동 라우팅(동적 디스커버리)
  - Router/Service/Middleware 모델로 정책을 구조화하여 적용

### 6.2 스트리밍(SSE/WebSocket) 및 네트워크 튜닝
- **Nginx OSS 강점**
  - 스트리밍 경로에서 버퍼링, 타임아웃, 헤더 제어를 보수적으로 튜닝하기 용이
  - 운영 레퍼런스가 많아 문제 해결이 빠름

- **Traefik**
  - 스트리밍 지원은 가능하나, 프로젝트 특성상 “동적 라우팅/자동화” 가치가 우선이며,
    스트리밍 세부 튜닝 요구가 강할수록 Nginx가 더 보수적 선택이 된다.

### 6.3 라우팅/정책 운영(빈도, 자동화)
- **Nginx OSS**
  - 라우팅/정책 변경이 잦아질수록 conf 관리 및 배포 자동화(템플릿/CI)가 필요

- **Traefik**
  - 컨테이너 라벨로 라우팅이 붙고, 서비스 증감/변경이 잦을수록 운영 효율 상승
  - 인증서 자동화(예: Let’s Encrypt)가 가능한 환경에서는 운영 UX가 좋아짐

### 6.4 보안 및 운영 리스크
- **Nginx OSS**
  - Docker socket 접근이 필요 없고 보안 면에서 단순
  - 조직 보안 규정(사내 CA, 수동 인증서 운영 등)에도 자연스럽게 부합

- **Traefik**
  - Docker Provider 사용 시 docker.sock 접근 설계가 필요(권한 과다 부여 위험)
  - 동적 설정 운영은 편리하지만, 초기 보안/권한 모델을 잘 설계해야 함

### 6.5 팀 역량/레퍼런스/유지보수
- **Nginx OSS**
  - 학습 비용이 낮고 레퍼런스/인력 수급이 용이
  - 표준적이며 장기 운영 시 예측 가능성이 큼

- **Traefik**
  - Router/Service/Middleware/Provider 모델을 팀이 이해해야 운영 품질이 올라감
  - GitOps/동적 운영 패턴에 익숙한 팀일수록 가치가 큼

---

## 7. 단계별 권고안

### 7.1 현 단계 권고: Nginx OSS 단독
적합 조건(현재 상황과 높은 정합성):
- 서버 내 Docker 환경(Compose)
- 서비스 수가 제한적이며 라우팅 변경 빈도가 낮거나 관리 가능한 수준
- LLM/음성 등 **스트리밍**이 중요하거나 네트워크 튜닝이 필요
- 소규모 팀으로 운영 복잡도 최소화가 최우선

권고 구성:
- Edge(80/443) = Nginx OSS
- 내부 서비스(FastAPI/Temporal/Inference Engine)는 Docker 네트워크로 연결

### 7.2 성장 이후 고려: Traefik 전환(또는 대안)
Traefik이 유의미해지는 트리거:
- Kubernetes로 전환
- 마이크로서비스 수 증가로 라우팅/정책 변경이 매우 빈번
- GitOps/Provider 기반 “동적 라우팅 자동화”가 운영 효율의 핵심이 됨

주의:
- 성장 이후에도 ingress-nginx/NGINX Ingress Controller 또는 Nginx 계열로 충분히 운영 가능한 경우가 많음.
- 따라서 “성장=Traefik”이 아니라 “운영 형태 변화=Traefik 후보군 강화”가 더 정확한 결론이다.

---

## 8. 빠른 의사결정 체크리스트(Yes/No)
다음 질문에서 어느 쪽이 더 많이 체크되는지로 결론을 내린다.

### Nginx OSS 쪽 가산점
- [ ] LLM SSE/WS 스트리밍이 핵심 트래픽이다.
- [ ] 타임아웃/버퍼링/헤더를 매우 보수적으로 통제해야 한다.
- [ ] 운영 구조를 단순화하고, 레퍼런스 기반 장애 대응을 우선한다.
- [ ] docker.sock 접근을 회피하고 싶다(보안 단순화).

### Traefik 쪽 가산점
- [ ] 서비스가 자주 생성/삭제되고 라우팅/정책 변경이 빈번하다.
- [ ] 라벨 기반으로 개발자가 셀프서비스로 라우팅을 붙이길 원한다.
- [ ] 인증서/라우팅 자동화가 운영 부담을 크게 줄인다.
- [ ] GitOps/동적 정책 운영 패턴이 이미 팀에 내재화되어 있다.

---

## 9. 전환 비용을 낮추는 운영 원칙(현재부터 적용)
Nginx OSS를 선택하더라도, 향후 Ingress/Traefik 전환을 대비해 아래를 표준으로 고정한다.

1) **Gateway 책임 분리**: TLS 종료/라우팅/공통정책만 Gateway에서 수행
2) **Backend 종속 제거**: 경로 규칙/리다이렉트 등 프록시 종속 로직을 백엔드에 넣지 않음
3) **API 계약 고정**: OpenAPI/에러코드/타임아웃 정책을 문서화하고 버전 관리
4) **관측 표준화**: request_id, latency, upstream_time, model_id, model_version 등 공통 로그 필드 정의

---

## 10. 최종 권고(Decision)
- **현 단계(서버 내 Docker, AI 기능 제공, 소규모 운영)**: **Nginx OSS 단독**을 채택한다.
- **향후 확장 단계**: “대규모”가 아니라 “운영 형태 변화(K8s+동적 라우팅/정책 자동화)”가 발생하면 Traefik(또는 ingress-nginx/NGINX Ingress Controller 포함)을 재평가한다.

---

## 부록 A. 공존이 필요한 예외 조건(정책/구조)
- DMZ/망분리 규정으로 인해 외부 진입점이 별도 계층으로 강제되는 경우
- 조직 보안 정책상 Edge 프록시는 고정 구성이 필요하고, 내부는 동적 라우팅이 필요한 경우

이 경우에도 공존은 최소화하고, 각 계층의 책임을 엄격히 분리한다.

